[{"title":"Grub 报错 unknown filesystem 的修复","url":"/2019/fix-for-grub-error-unknown-filesystem/","content":"\nWarning: 这是一篇从硬盘里翻出来的旧文\n\n记录了下在安装 Manjaro 的基础上安装 Windows 10 而导致的 grub 引导失败报 unknown filesystem 的修复过程。\n\nTL;DR适用于 UEFI ！！！\ngrub rescue\n迭代 ls 找到 manjaro 所在的分区 (hdx,gptx)set prefix&#x3D;(hdx,gptx)&#x2F;boot&#x2F;grubset root&#x3D;hdx,gptxinsmod normalnormal\n\n进入系统后\nmount | grep /boot/efi # 找到 efi 所在分区 /dev/sdaxsudo update-grubsudo grub-install /dev/sdax\n\n完结撒花！\n问题描述因为种种原因，需要在笔记本上临时装个 Win10。于是找到启动盘，安装镜像，一顿操作后重启。发现居然直接进了 Win10 ，隐约感觉有点不对劲，但忍住疑惑开始边进行繁琐的 Win10 配置， 边观看世界赛半决赛 T1 vs G2。配置的差不多后重启进入 Manjaro 却悲剧了。告诉我引导失败，报了 unknown filesystem，并贴心的进入了 grub rescue 模式。这时反应过来可能是安装工具改了磁盘挂载导致 grub 加载失败。\n解决Grub 运行模式Grub 有两种运行模式， normal 和 rescue ，normal 就是正常情况下那个包含了菜单界面的模式，而当 grub 发现错误时，就会进入 rescue 模式\nrescue 的常用命令如下：\n\n\n\n\n说明\n\n\n\nset\n查看、编辑环境变量\n\n\nls\n查看分区信息\n\n\ninsmod\n加载模块\n\n\n修复 grub 配置\n使用 ls 命令，列出所有分区。\n依次使用 ls (分区)/ 命令，直到分区可读且列出了 Manjaro 的 / 为止。记下根目录所在分区 (hdx,gptx)。\n输入 set prefix=(hdx,gptx)/boot/grub 和 set root=hdx,gptx，更改环境变量 prefix 和 root。\n执行 insmod normal 载入 normal 模块\n执行 normal 进入 normal 模式，此时应该可以正常引导进入 Manjaro.\n\n（可选）控制台模式该小节来自网络，没有尝试过\n进入普通模式，出现菜单，如果加载grub.cfg（错误的）可能出现问题，按shift可以出现菜单，之后按c键进入控制台\n\n进入正常模式后就会出现grub&gt;这样的提示符，在这里支持的命令就非常多了。 \n引导系统\nset root&#x3D;(hd0,msdos1)  #设置正常启动分区linux &#x2F;boot&#x2F;vmlinuz ....  ro text root&#x3D;&#x2F;dev&#x2F;sda1  #加载内核，进入控制台模式initrd  &#x2F;boot&#x2F;initrd ....  #加载initrd.imgboot #引导\n\n更新 grub进入系统后，打开终端：\n\n执行 mount | grep /boot/efi，记下 efi 分区的位置 /dev/sdax\n执行 sudo update-grub ，该操作会自动检测安装的操作系统，更新 grub 菜单。\n执行 sudo grub-install /dev/sdax，重新安装。\n\n","categories":["技术","grub"],"tags":["grub","manjaro","uefi"]},{"title":"使用 Jenkins 和 Gitee 自动部署博客","url":"/2021/automating-blog-deployment-with-jenkins-and-gitee/","content":"本文介绍如何在自建服务器上使用 Jenkins 和 Gitee 自动部署博客。\n\n\n\n\n最近给域名备了个案，于是花了点时间把博客从 Vercel 迁移到了国内服务器上。之前用的 Vercel 是能够在 Git 仓库发生变更后自动部署的，但迁到自建服务器上后这个功能就得自己实现了，搜索了一下实现方案，最后选用了 Jenkins。\n环境信息\n\n\n环境\n版本\n\n\n\n操作系统\nCentOS 7\n\n\nJenkins\n2.277.4\n\n\nJDK\n1.8.0_282\n\n\nNginx\n1.18.0\n\n\nGit Host\nGitee\n\n\n配置 Jenkins安装 Jenkins参考 官方文档 安装即可， CentOS 的步骤如下 ：\n# 添加 Yum 源sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo# 导入密钥sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.keysudo yum install -y jenkins\n\n（可选）Jenkins 默认端口为 8080，可以在配置文件里修改：\nvim /etc/sysconfig/jenkins# 修改 JENKINS_PORT=xxx 即可\n\n最后添加开机启动：\n# 重载服务（由于前面修改了 Jenkins 启动脚本）sudo systemctl daemon-reload# 启动 Jenkins 服务sudo systemctl start jenkins# 将 Jenkins 服务设置为开机启动# 由于 Jenkins 不是 Native Service，所以需要用 chkconfig 命令而不是 systemctl 命令sudo /sbin/chkconfig jenkins on\n\nJenkins 初始化确保之前设置的端口在防火墙里已开放，然后浏览器访问 &lt;ip&gt;:&lt;port&gt;，按照向导一步步完成初始化。\n安装插件安装配置 NodeJS Plugin登录 Dashboard，选择 Manage Jenkins &gt; Manage Plugins，点击 Available，安装 NodeJS Plugin。\n然后在 Dashboard &gt; Manage Jenkins &gt; Global Tool Configuration 里下滑找到 NodeJS ，点击 NodeJS installations …，配置如下：\n\n\n选择 Node 版本，在 Global npm packages to install 里填入 Hexo 和 Yarn 依赖：\nhexo-cli@4.2.0 yarn --registry https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F; \n\n点 Save 保存。\n安装 Gitee Plugin由于 Github 在国内网络几乎不可用，这里把 Host 换成了 Gitee，因此还需要安装一个 Gitee Plugin。\nGitee 的配置参考 Gitee 的官方帮助中心：\n简单来说，在 Jenkins -&gt; Manage Jenkins -&gt; Configure System -&gt; Gitee Configuration -&gt; Gitee connections 里，按照文档配置如下：\n\n\n添加 CI 任务配置密钥（可跳过）由于我博客项目设置为了私人仓库，所以需要额外生成密钥对并把公钥添加到 Gitee 里，如果你的仓库是公开状态，这一步可以跳过：\n切换到 Jenkins 用户：\nsudo su -s /bin/bash jenkins\n\n生成密钥对：\nssh-keygen -o\n\n查看公钥并复制：\ncat ~&#x2F;.ssh&#x2F;id_rsa.pub\n\n然后在 Gitee 网站右上角 个人头像 &gt; 设置 &gt; SSH公钥 里粘贴公钥，点确定保存。\n新建任务新建任务接下来就可以在 Jenkins 里新建构建博客的 CI 任务了！\n打开 Dashboard，点击 New Item。输入 Item name，类型选择 Freestyle project。配置页里 Gitee connection 选择之前配置的 connection。\n在 Source Code Management 里选择 Git，Repository URL 里填入仓库连接，如果这个时候显示权限失败，请返回上一小节配置密钥。\n在 Build Triggers 里选择 Build when a change is pushed to Gitee. Gitee webhook URL: http://81.70.155.173:8089/gitee-project/blog ，注意复制这里的 webhook url，之后会用到。\n然后再 Enabled Gitee triggers 里选中 Push Events，Secret Token for Gitee WebHook 里点击 Generate，同样保存备用。\nGitee 配置 Webhook之前配置的 Webhook 需要在 Gitee 上同样配置一下才能正常工作：\n登陆 Gitee 后在仓库主页点击 管理 &gt; WebHooks &gt; 添加 WebHooks，然后填入刚刚保存的 url 和 token，保存即可。\n编写构建脚本回到任务配置页，继续添加自动构建脚本：\n在 Build 里点击 Add build step，选择 Execute shell，根据网站和博客的具体情况编写构建部署命令如下：\n# 不安装 devDependencesyarn install --prod --registry https://registry.npm.taobao.org/# Hexo 生成脚本hexo cleanhexo generate# 部署脚本rm -rf /www/wwwroot/mysite/*cp -a ./public/. /www/wwwroot/mysite/\n\n测试部署完成 CI 任务的创建后，回到 Project 页面，点击 Build now，观察是否一切正常。然后通过 Git 更改后 push，测试 WebHook 是否正常。\n其他推送原来用 Vercel 的时候，每次构建完毕，Vercel Bot 就会给我的仓库的 Commit 评论一下，然后会收到 Github 发来的邮件，提醒我构建完成，非常好用。当然，现在这个功能也只能自己写了。因为是国内服务器，直接排除了用 Telegram 推送。搜索了一下，发现了一个通过 QQ 推送消息的网站 Qmsg酱，按照文档注册配置后可以获得一个 Qmsg Key，然后就可以调用 RESTful 接口发起推送了！\n配置非常简单，在构建脚本的最后添加如下命令即可：\ncurl --location --request POST &#x27;https://qmsg.zendee.cn/send/&lt;你的 qmsgKey&gt;&#x27; \\--header &#x27;Content-Type: application/x-www-form-urlencoded&#x27; \\--data-urlencode &#x27;msg=itiandong.com 部署成功&#x27;\n\n这样每次部署完成，你会收到一条 QQ 消息：\n\n\n国内网络的坑这次迁移的过程中也遇到了一些坑。最开始本来打算沿用 Github 的，但测试发现 Clone 总是出错，于是被迫改成国内的 Gitee。可以在原仓库上额外添加 Gitee 远程仓库地址，让 Github 和 Gitee 并存：\ngit remote add gitee &lt;url&gt;\n\n然后提交时，分别执行：\ngit push origin mastergit push gitee master\n\n就可以分别提交到两个仓库里了。\n另外，博客用到的一个插件 hexo-all-minifier  也遇到了类似的问题。这个插件的安装脚本 install.js 会从 githubusercontent.com 里下载文件，而国内这个域名直接被 ban 了… 无语…于是我暂时去掉了这个插件，如果想解决可能需要重打包一下了…\n","categories":["技术","Hexo"],"tags":["Hexo","CI","Jenkins","博客","配置"]},{"title":"博客添加了脚标功能！","url":"/2021/footnotes-test/","content":"这是一篇用来测试脚标功能的测试贴。今天想给博客整个脚标参考文献功能，搜索一番发现并没有合适的包。于是花了一下午时间，基于 hexo-reference[1] 重写了下，修复了一些 Bug。然后主要是把解析器改成了博客正在用的 marked（原包使用的 markdown-it ），以及把原来的 Hint.css 改为更加好看的 Tippy.js[2]。\n功能测试Markdown 原文\n\n\n渲染结果\n\n基本脚注[3]，点击可以跳转到相应的参考文献。\n这是行内脚标[4]，行内脚标支持 Markdown。\n这是个带图片的脚标[5]\n\n\n渲染结果就是上面这样子啦！桌面端鼠标放在上标上会有内容弹窗[6]，触屏设备则需要按住不动 0.5 秒，该行为可以在 Tippy.js 中设置[7]。\nTODO\n 有时间打包成插件公开出来；\n 定位不准的问题；\n 定位后高亮提示;\n a 链接与 touch 操作矛盾；\n 引用自动编号功能；\n 同一文献多处引用的功能；\n\nReference[1]hexo-reference 仓库↩[2]Tippy.js 官网↩[3]基本脚注。↩[4]行内参考文献↩[5]图片脚标 \n↩[6]内容弹窗↩[7]Tippy.js &gt; All Props &gt; touch↩","categories":["技术","Hexo"],"tags":["Hexo","脚标","参考文献"]},{"title":"Google Colaboratory 小技巧","url":"/2021/colab-tips/","content":"最近在用 Google Colaboratory 跑实验，开一贴用来记录、整理一些使用过程中发现的小技巧。不定期更新。\n\n\n修订记录\n2021年5月14日 初版目录\n\n白嫖无限盘存储数据集Colab 是可以挂载 Google Drive 来导入训练需要的数据集的，但 Google Drive 只有 15Gb 的免费空间，稍微多放几个数据集空间就不够用了。为了解决这个问题，你当然可以直接花钱购买存储空间，100Gb 空间的价格差不多是 2 美元一个月。但鉴于数据集也不是啥隐私数据（主要是穷），于是我就找了些免费的团队盘来存储。团队盘大概是谷歌云盘的企业方案提供的功能，企业可以建立一个独立的团队盘，无空间限制并且可以自由添加管理员或者内容管理者。团队盘和云盘用起来没啥区别，都可以挂载到 Colab 里，但并不稳定（可能会被企业回收）且企业管理员可以看到所有团队盘的内容，所以不要在里面放任何隐私文件！\n至于如何申请到免费的团队盘，我随便在 Youtube 上搜到了一个视频教程，里面给出了一些网址如下图。其中我只试了第一个网址就成功申请到了：\n\n\n\n\n免费账户使用高内存高算力GPU之前在推特上刷到一个免费用户白嫖 P100 的推文，只要使用指定的 ipynb 文件就能申请到 P100。当时看到也第一时间尝试了一下，果然可以 100% 申请到 P100，而且还是高内存机器！笔记本地址：P100.ipynb。\n不过我最近也没有这样用过了，也不知道现在（2021年5月14日）这个方法还能不能稳定使用，刚尝试了一次，申请到的是较弱的 Tesla T4。 至于为啥我最近没有这样用了，因为… 我氪金上 Colab Pro了（手动狗头）\n\n\n在 Colaboratory 中运行 Shell 命令Colab 实际上是一个在线的 Jupyter notebook，在 notebook 里，可以在命令行前加上”!”执行 Shell 命令：\n!pip install xxx\n\n但这样是存在缺陷的，当通过这种方式执行命令时，脚本会在一个临时的 SubShell 里执行，所以譬如运行 !cd EpicWord 的命令时是没有达到预期效果的（当然这里可以用 magic methods %cd 改变工作目录，或者直接用 automagic methods cd，后文也会提到）。一个优雅地运行 Shell 命令的方式是使用工具函数 run，该函数接受命令列表和工作路径，创建对应的 sh 脚本，自动 cd 到工作目录并按顺序执行命令：\n&quot;&quot;&quot;Helper to run command formated in python.&quot;&quot;&quot;def run(cmds, root=&quot;/content&quot;):  if not isinstance(cmds, list):    cmds = [cmds]  os.system(f&quot;echo cd &#123;root&#125; &gt; cmd.sh&quot;)  for cmd in cmds:    os.system(f&quot;echo &#123;cmd&#125; &gt;&gt; cmd.sh&quot;)  !bash cmd.sh\n\n用起来非常方便，一些例子如下：\n# 查看 GPU 信息run(&quot;nvidia-smi&quot;)# 解压准备数据集run([     f&#x27;tar -xf &#123;mini_imagenet_tar_dir&#125;/train.tar -C &#123;ds_target_dir&#125;&#x27;,     f&#x27;tar -xf &#123;mini_imagenet_tar_dir&#125;/test.tar -C &#123;ds_target_dir&#125;&#x27;,     f&#x27;tar -xf &#123;mini_imagenet_tar_dir&#125;/val.tar -C &#123;ds_target_dir&#125;&#x27;,])# 更新实验代码run(&quot;git pull&quot;, f&quot;/content/&#123;repository&#125;&quot;)# 运行模型代码run(    r&#x27;python train_fsl.py --save_dir /content/drive/MyDrive/savedirs  --max_epoch 200 ...&#x27;,    f&quot;/content/&#123;repository&#125;&quot;)\n\n这种方式可以满足大部分运行命令行的需求，顺带提一句，如果你想在当前笔记本的 IPython 环境里运行 Python 代码，可以这样做：\n%cd EpicWork%run main.py\n\n使用 Github 私人仓库托管代码使用 Tensorboard 监控实验状态Telegram 推送训练日志","categories":["技术","Colab"],"tags":["Colab","实验","深度学习"]},{"title":"你好，世界","url":"/2021/hello-world/","content":"这个人很忙，正在复习《凸优化方法》，一会儿回来…\n\n\n测试目录我爱优化方法\n测试测试公式\n\n\n测试图片\n测试代码print('我爱优化方法')","categories":["日常"],"tags":["Hello World"]},{"title":"论文笔记：Orthogonal Projection Loss","url":"/2021/paper-OPL/","content":"本文提出了一个简单的损失函数OPL, Orthogonal Projection Loss，以保持 特征空间 上的正交性。OPL 和交叉熵损失组合使用，且没有额外的学习参数，因而可以植入现有的任何包含交叉熵损失的深度神经网络模型中。\n\n\n基本信息\n论文标题：Orthogonal Projection Loss.[1]\n作者：Kanchana Ranasinghe, Muzammal Naseer, Munawar Hayat, Salman Khan, Fahad Shahbaz Khan\nPDF：arxiv[2]\n代码：Github[3]\n\n介绍背景本文对 Softmax交叉熵损失  开刀，可以看作给交叉熵损失加了个 Buff。作者观察到：交叉熵损失虽然鼓励了某个样本在正类向量（通常是 one-hot 形式）上的投影比负类向量高，但是没有 显式 的让不同类别的样本足够分开。基于此，作者开发了一个新的损失函数 正交投影损失, OPL，通过在 mini-batch 上的特征空间里显式地进行类内内聚和类间分离，弥补了交叉熵损失的不足。\n竞品分析\n以下内容均来源于本文[1]的自卖自夸，没来得及确认，不代表个人观点（逃\n\n损失函数们：\n\nContrastive  和  Triplet  损失：严重依赖于负样本（评：其实现在有压根不需要负样本的对比学习方法。如：BYOL）。而 OPT 直接在 mini-batch 上操作，不依赖负样本；\n基于 Center Loss [4]的方法们，引入了额外的学习参数[5]。而 OPT 没有额外参数；\n强行加一个 margin ，比如加一个固定的欧式的 margin  的方法们。这些方法的缺点是：1.  与交叉熵结合的不自然，而且可能会学到负相关性，也就是说本来两个类别已经隔的很远了，你却还要关注他们，让它们再远一点。而后面可以看到，OPT 就“自然”多了，它强化的是 CE 本身就有的属性（正交性）；\n基于  Angular Margin[6] 的方法们， 在人脸识别上效果优异，其内在的假设对于其他计算机视觉任务可能不具有一般性。而 OPT 可以植入任何 DNN 中；\n其他依赖具体网络结构的方法，如这篇论文[7]。而 OPT 不依赖具体模型结构；\n其他基于特征空间正交性的方法们依赖于 SVD ，数值不稳定。\n\n本文贡献\n提出了一个新的损失函数 OPT；\nOPT 算法可以很好的向量化加速；\n在多个任务验证了 OPT 的有效性，包括：各种图像分类任务、小样本任务、域自适应任务。并且具有很好的鲁棒性，如应对 对抗攻击 和 噪音标签 上。\n\n具体方法SCE Loss 的分析Sofmax 交叉熵损失的公式如下：\n有一些方法改进 CE 来扩大决策边界[8]：\n\n\n\n详见[8]，这些方法的缺点是梯度不好算以及 cos 函数不单调什么的，所以现有方法都用了数学近似。\nOP Loss 形式OP Loss 的定义如下，也就是让  趋近于 1， 趋近于0：\n 表示一个 mini-batch。\n\nPytorch 代码如下，可以看到，OPL 算法很好的向量化加速：\n\n\n另外，没有权重的 OPL 损失可以写作如下形式：【】\nOP Loss 分析正交性分析作者做了正交性的可视化如下图，颜色代表某两个类之间的夹角余弦值，具体分析详见原文[1]：\n\n\n\n\n常量分析下图分别是特征正交性、同类相似性和不同类相似性随训练的变化：\n\n\n\n\n实验这里罗列一些实验结果，更多结果见原文[1]。\n图像分类CIFAR-100 和 ImageNet\n\n\n\n预测质量分析\n\n\n\n小样本学习\n\n消融实验\n\n总结\n本文提供了一个简单和有效的损失，可以用在各种模型上；\n可以探讨该方法在无监督学习中的效果。\n\nReference[1]Ranasinghe, K., Naseer, M., Hayat, M., Khan, S. &amp; Khan, F. S. Orthogonal Projection Loss. (2021). arxiv↩↩↩↩[2]arxiv↩[3]Github | Pytorch↩[4][ECCV 2016] A Discriminative Feature Learning Approach for Deep Face Recognition↩[5]类中心 c 是一个参数↩[6]Liu W, Wen Y, Yu Z, et al. SphereFace: Deep Hypersphere Embedding for Face Recognition[J]. arXiv preprint arXiv:1704.08063, 2017.↩[7]Guolei Sun, Salman Khan, Wen Li, Hisham Cholakkal, Fahad Khan, and Luc Van Gool. Fixing localization errors to improve image classification. ECCV, 2020↩[8]Deng, J., Guo, J., Xue, N. &amp; Zafeiriou, S. ArcFace: Additive Angular Margin Loss for Deep Face Recognition. arXiv:1801.07698 [cs] 2019↩↩","categories":["论文笔记","损失函数"],"tags":["论文笔记","小样本","损失函数"]},{"title":"测试首页隐藏功能","url":"/2021/test-to-hide-the-article-on-the-home-page/","content":"这是一篇用来测试首页隐藏功能的测试贴。如果不出意外，这篇文章并不会在首页演示。\n为什么可能有的文章并不适合在首页展示，但需要罗列在归档中。\n如何做修改源码文章内加入 hide 字段，然后修改 hexo-pagination 包的 lib\\pagination.js 文件，添加如下代码：\n// if (base &amp;&amp; !base.endsWith(&#x27;/&#x27;)) base += &#x27;/&#x27;;posts = posts.filter(p =&gt; !p.hide)// const &#123; length &#125; = posts;\n\n替换官方包简单打包了一下，也可以直接修改官方包如下：\nyarn remove hexo-generator-indexyarn add hexo-generator-index-tilden","categories":["技术","Hexo"],"tags":["Hexo"]},{"title":"categories","url":"/categories/index.html","content":""},{"url":"/404/index.html","content":"\ndocument.title = '页面未找到';\nif (document.querySelectorAll('head link.style404').length === 0) {\n    (function(d) {\n    const s1 = d.createElement('link');s1.classList.add(\"style404\");\n    s1.rel='stylesheet';s1.href = '/css/404.css';\n    (d.getElementsByTagName('head')[0]).appendChild(s1);\n    })(document)\n}\n\n您访问的页面未找到\n\n\n\n\n\n\n \n返回 首页"},{"title":"about","url":"/about/index.html","content":"About me"},{"title":"links","url":"/links/index.html","content":"申请友链就按照下面的格式回复就好啦，看到会加上~\n友链格式：\n- name: # &lt;站点名称&gt;  link: https://example.com/  description: # &lt;一句话描述&gt;  avatar: # &lt;头像url&gt;\n本站信息：\n- name: Tilden&#x27;s Notes  link: https://itiandong.com/  description: Tilden 的笔记  avatar: https://itiandong.com/images/avatar.jpg"},{"title":"我现在在做什么","url":"/now/index.html","content":"我现在在做什么\n最后更新：2021年4月28日\n\n本页面灵感来自 nownownow[1]。\n现况在大连读研[2]，已经学完了所有课程，也考完了所有的试，现在每天主要的事情大概就剩看论文和写实验室的项目了吧 :/。另外闲时尽量做些有趣的事情，比如 学前端 、看 Mooc 以及 谈恋爱。最近也在尝试坚持跑步🏃‍♂️。\n正在做的事\n合伙创业项目的开发。\n看 小样本学习[3] 和 自监督学习[4] 方面的论文和代码。\n实验室的项目们：大连湾政务、智慧农业、东北电力知识图谱。\n看 CS224W [5] 网课。\n学前端。\n控糖😢。\n\n正在看的书\nPython深度学习基于PyTorch[6]\n\nReference[1]nownownow.com↩[2]SSDUT↩[3]Meta learning↩[4]Unsupervised learning↩[5]CS224W | Home↩[6]电子版↩"},{"title":"tags","url":"/tags/index.html","content":""}]